<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Portal de Den√∫ncias Institucionais (Simula√ß√£o)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Vari√°veis e Estilos Customizados */
        :root {
            --accent: #d24b3b;
            --muted: #666;
            --bg: #f7f7f7;
        }
        body {
            /* Adicione uma fonte mais moderna (como Inter) caso seja necess√°rio importar */
            font-family: 'Inter', Arial, sans-serif;
            background-color: var(--bg);
            color: #222;
        }

        /* Cores e estilos do Checklist */
        .check-item.ok {
            border-left: 4px solid #2e8b57; /* Verde escuro */
            background-color: #f6fffb; /* Verde claro */
        }
        .check-item.nok {
            border-left: 4px solid #d9534f; /* Vermelho escuro */
            background-color: #fff6f6; /* Vermelho claro */
        }
        .submission-preview pre {
            background-color: #1f2937; /* Gray-800 */
            color: #a8f0a8; /* Verde Neon */
            padding: 1rem;
            border-radius: 0.375rem; /* rounded-lg */
            overflow: auto;
            margin-top: 0.75rem; /* mt-3 */
            font-family: monospace; /* Garante a monospaced font */
        }
        .btn-primary {
            background-color: #0b5fff;
            color: #fff;
        }
        .btn-secondary {
            background-color: #eee;
            color: #333;
        }

        /* Layout responsivo para main-inner */
        .main-inner {
            display: flex;
            gap: 2rem;
            flex-direction: column;
        }

        @media (min-width: 1024px) {
            .main-inner {
                flex-direction: row;
            }
            .aside {
                width: 300px;
                flex-shrink: 0;
            }
        }
    </style>
</head>

<body class="min-h-screen">
    <div id="app-root" class="page">
        </div>

    <div id="message-box" class="fixed inset-0 z-50 bg-black bg-opacity-40 hidden" onclick="hideMessage()">
        <div class="bg-white p-6 rounded-lg shadow-2xl max-w-sm mx-auto my-20" onclick="event.stopPropagation()">
            <h4 class="text-xl font-bold mb-3 text-gray-800">Aviso</h4>
            <p id="message-text" class="text-gray-700 mb-6"></p>
            <div class="flex justify-end space-x-3">
                <button onclick="hideMessage(false)" id="confirm-btn-cancel" class="px-4 py-2 text-sm text-gray-600 rounded-lg hover:bg-gray-100 hidden">Cancelar</button>
                <button onclick="hideMessage(true)" id="confirm-btn-ok" class="px-4 py-2 text-sm text-white bg-blue-600 rounded-lg hover:bg-blue-700">OK</button>
            </div>
        </div>
    </div>

    <script>
        // =================================================================
        // Vari√°veis de Estado (Simulando React State)
        // =================================================================
        let submitted = false;
        // Objeto 'form' inicializado com strings vazias para melhor controle
        let form = { nome: "", cpf: "", email: "", telefone: "", descricao: "" };
        let lastSubmission = null;
        let confirmAction = null; // Fun√ß√£o de callback para a caixa de confirma√ß√£o

        // =================================================================
        // Fun√ß√µes de UI (Substituindo alert/confirm)
        // =================================================================
        const messageBox = document.getElementById('message-box');
        const messageText = document.getElementById('message-text');
        const confirmBtnOk = document.getElementById('confirm-btn-ok');
        const confirmBtnCancel = document.getElementById('confirm-btn-cancel');

        function showMessage(text, isConfirm, callback) {
            messageText.textContent = text;
            messageBox.classList.remove('hidden');
            confirmAction = callback; // Atribui a fun√ß√£o de callback

            if (isConfirm) {
                confirmBtnCancel.classList.remove('hidden');
                confirmBtnOk.textContent = 'Confirmar';
            } else {
                confirmBtnCancel.classList.add('hidden');
                confirmBtnOk.textContent = 'OK';
            }
        }

        function hideMessage(result) {
            messageBox.classList.add('hidden');
            // Executa a fun√ß√£o de callback, passando o resultado (true/false)
            if (confirmAction) {
                confirmAction(result);
                confirmAction = null; // Limpa a a√ß√£o ap√≥s a execu√ß√£o
            }
        }


        // =================================================================
        // Fun√ß√µes de Componentes (Substituindo React Components)
        // =================================================================

        // Helper para criar a lista de itens do checklist
        function createChecklistItem(item) {
            // Usa as classes Tailwind para cores e layout
            const icon = item.ok ? '‚úÖ' : '‚ùå';
            const colorClass = item.ok ? 'ok' : 'nok';
            
            return `
                <div class="check-item p-3 rounded-lg flex items-center ${colorClass}">
                    <div class="check-left flex gap-3 items-start w-full">
                        <div class="bullet text-xl flex-shrink-0">${icon}</div>
                        <div>
                            <div class="question font-semibold">${item.text}</div>
                            <div class="detail text-sm text-gray-500 mt-1">${item.detail}</div>
                        </div>
                    </div>
                </div>
            `;
        }

        // Checklist Component
        function ChecklistHTML(submission) {
            if (!submission) {
                return `
                    <section class="checklist-section w-full lg:w-3/4">
                        <div class="checklist-wrapper bg-white p-7 rounded-lg shadow-md">
                            <h2 class="text-2xl font-bold mb-4 text-gray-800">Checklist de Verifica√ß√£o Institucional</h2>
                            <p class="text-gray-600">Nenhuma submiss√£o encontrada para validar.</p>
                            <div class="mt-6">
                                <button onclick="handleBack()" class="btn px-4 py-2 rounded-lg font-semibold btn-primary">Voltar ao formul√°rio</button>
                            </div>
                        </div>
                    </section>
                `;
            }

            // L√≥gica de valida√ß√£o
            // Estas s√£o simula√ß√µes. Mantenha os valores l√≥gicos (true/false) para o checklist funcionar.
            const hasHTTPS = true; 
            const domainLooksOfficial = false;
            const hasContact = !!(submission.email || submission.telefone);
            const hasSignatureOrSeal = !!submission.nome;
            const mentionsPrivacy = submission.descricao && submission.descricao.length > 20;

            const items = [
                { text: "O site possui certificado HTTPS v√°lido?", ok: hasHTTPS, detail: hasHTTPS ? "üîí Certificado aparentemente presente (simulado)" : "‚ùå Sem HTTPS" },
                { text: "O dom√≠nio √© realmente da institui√ß√£o (ex: .gov.br / .edu.br)?", ok: domainLooksOfficial, detail: domainLooksOfficial ? "‚úÖ Dom√≠nio parecido com institucional" : "‚ùå Dom√≠nio n√£o verificado (simulado)" },
                { text: "H√° canais oficiais de contato confirmando o formul√°rio?", ok: hasContact, detail: hasContact ? `‚úÖ Contato presente: ${submission.email || submission.telefone}` : "‚ùå Sem contato fornecido" },
                { text: "H√° assinatura ou selo institucional vis√≠vel?", ok: hasSignatureOrSeal, detail: hasSignatureOrSeal ? `‚úÖ Nome informado: ${submission.nome}` : "‚ùå Nome n√£o informado" },
                { text: "O conte√∫do informa pol√≠tica de privacidade e uso de dados?", ok: mentionsPrivacy, detail: mentionsPrivacy ? "‚úÖ Texto longo descrevendo o caso (simula√ß√£o)" : "‚ùå N√£o h√° texto suficiente mencionando privacidade" },
            ];

            const itemsHtml = items.map(createChecklistItem).join('');
            const previewJson = JSON.stringify(submission, null, 2);

            return `
                <section class="checklist-section w-full lg:w-3/4">
                    <div class="checklist-wrapper bg-white p-7 rounded-lg shadow-md">
                        <h2 class="text-2xl font-bold mb-4 text-gray-800">Checklist de Verifica√ß√£o Institucional ‚úÖ</h2>
                        <p class="text-gray-600 mb-6">Avaliando os dados da sua √∫ltima submiss√£o (usados apenas para demonstrar o checklist):</p>
                        <div class="checklist-items flex flex-col gap-3">
                            ${itemsHtml}
                        </div>
                        <div class="submission-preview mt-6">
                            <h3 class="text-lg font-semibold mb-2">Preview (dados usados na verifica√ß√£o)</h3>
                            <pre>${previewJson}</pre>
                        </div>
                        <div class="mt-6 flex gap-3">
                            <button onclick="handleBack()" class="btn px-4 py-2 rounded-lg font-semibold btn-primary hover:bg-blue-700 transition">Voltar ao formul√°rio</button>
                            <button type="button" onclick="handleClearStorageConfirm()" class="btn px-4 py-2 rounded-lg font-semibold btn-secondary hover:bg-gray-200 transition">Limpar Storage</button>
                        </div>
                    </div>
                </section>
            `;
        }

        // Form Component (Principal View)
        function FormHTML() {
            // O atributo 'value' n√£o √© usado para <textarea>.
            // Os valores dos inputs s√£o atualizados via JS na fun√ß√£o bindFormToState.
            return `
                <section class="form-section flex-1 bg-white p-7 rounded-lg shadow-md">
                    <h1 class="text-3xl font-bold mb-4 text-gray-800">Fale Conosco ‚Äî Ouvidoria</h1>
                    <p class="lead text-gray-500 mb-6">
                        Este √© um <strong>ambiente de simula√ß√£o</strong> criado para ensinar como verificar a autenticidade de formul√°rios.
                        <br>
                        Preencha abaixo ‚Äî os dados ser√£o salvos em <code>localStorage</code> (n√£o enviados a servidor).
                    </p>

                    <form onsubmit="handleSubmit(event)" id="denuncia-form" class="formulario space-y-4" autocomplete="off">
                        <div class="row">
                            <label for="nome" class="block font-semibold mb-1">Nome completo</label>
                            <input name="nome" type="text" id="nome" 
                                class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" 
                                required />
                        </div>

                        <div class="row two flex gap-4 flex-col sm:flex-row">
                            <div class="flex-1">
                                <label for="cpf" class="block font-semibold mb-1">CPF</label>
                                <input name="cpf" type="text" id="cpf" 
                                    class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" 
                                    required />
                            </div>
                            <div class="flex-1">
                                <label for="telefone" class="block font-semibold mb-1">Telefone</label>
                                <input name="telefone" type="tel" id="telefone" placeholder="(99) 99999-9999" 
                                    class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" />
                            </div>
                        </div>

                        <div class="row">
                            <label for="email" class="block font-semibold mb-1">E-mail</label>
                            <input name="email" type="email" id="email" 
                                class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500" 
                                required />
                        </div>

                        <div class="row">
                            <label for="descricao" class="block font-semibold mb-1">Descri√ß√£o da den√∫ncia</label>
                            <textarea name="descricao" id="descricao" required rows="6" 
                                class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-none"></textarea>
                        </div>

                        <div class="actions flex gap-3 items-center pt-4">
                            <button type="submit" class="btn px-4 py-2 rounded-lg font-semibold shadow-md hover:shadow-lg transition btn-primary hover:bg-blue-700">Enviar den√∫ncia</button>
                            <button type="button" onclick="handleClearStorageConfirm()" class="btn px-4 py-2 rounded-lg font-semibold btn-secondary hover:bg-gray-200 transition">Limpar Storage</button>
                        </div>
                    </form>
                </section>
            `;
        }

        // =================================================================
        // Fun√ß√µes de Manipula√ß√£o de Estado (Simulando React Hooks)
        // =================================================================

        function setFormState(newForm) {
            form = newForm;
            // Ap√≥s atualizar o estado JS, re-renderiza ou sincroniza
            // Como o form est√° na mesma view, a sincroniza√ß√£o √© mais r√°pida
            if (!submitted) {
                 bindFormToState();
            }
        }

        function setSubmittedState(isSubmitted) {
            submitted = isSubmitted;
            render(); // Renderiza novamente toda a aplica√ß√£o para mudar de view
        }

        function setLastSubmissionState(submission) {
            lastSubmission = submission;
        }

        /**
         * Sincroniza o estado 'form' do JS com os campos de input/textarea do DOM.
         */
        function bindFormToState() {
            const formElement = document.getElementById('denuncia-form');
            if (formElement) {
                // Itera sobre todas as chaves no objeto 'form'
                Object.keys(form).forEach(key => {
                    const element = formElement.querySelector(`[name="${key}"]`);
                    if (element) {
                        // Para <textarea>, use textContent/innerHTML, mas value funciona no JS. 
                        // O importante √© definir o valor.
                        if (element.tagName === 'TEXTAREA') {
                            element.value = form[key];
                        } else {
                            element.value = form[key];
                        }
                        // Adiciona o listener de input para manter o estado JS atualizado
                        element.oninput = handleChange;
                    }
                });
            }
        }


        function handleChange(event) {
            const { name, value } = event.target;
            // Atualiza o estado JS
            form = { ...form, [name]: value };
            
            // Opcional: Atualiza o DOM do elemento imediatamente para evitar falhas de re-renderiza√ß√£o
            // Como o FormHTML √© grande, atualizamos o estado e deixamos o JS fazer a atualiza√ß√£o.
            // Para performance em Vanilla JS, atualize o DOM do elemento individualmente.
            event.target.value = value;
            
        }

        function handleSubmit(event) {
            event.preventDefault();

            // L√≥gica de manipula√ß√£o de dados
            const nova = { ...form, data: new Date().toISOString() };
            const listaExistente = JSON.parse(localStorage.getItem("denuncias")) || [];
            
            listaExistente.push(nova);
            localStorage.setItem("denuncias", JSON.stringify(listaExistente));

            // Atualiza estado e muda a view
            setLastSubmissionState(nova);
            setFormState({ nome: "", cpf: "", email: "", telefone: "", descricao: "" }); // Limpa o formul√°rio
            setSubmittedState(true); // Muda a view para o checklist
        }

        function handleBack() {
            setSubmittedState(false); // Volta para a view do formul√°rio
        }
        
        function handleClearStorageConfirm() {
            showMessage("Tem certeza que deseja limpar todas as den√∫ncias salvas no localStorage?", true, (confirmed) => {
                if (confirmed) {
                    localStorage.removeItem("denuncias");
                    setLastSubmissionState(null);
                    // Garante que a view volta para o formul√°rio
                    setSubmittedState(false); 
                    // Mostra uma mensagem de sucesso ap√≥s limpar
                    showMessage("LocalStorage limpo com sucesso.", false);
                }
            });
        }


        // =================================================================
        // Renderiza√ß√£o Principal e Estrutura
        // =================================================================

        function render() {
            const root = document.getElementById('app-root');
            
            const mainContent = submitted ? 
                ChecklistHTML(lastSubmission) : 
                FormHTML();

            root.innerHTML = `
                <header class="header bg-white border-b border-gray-200">
                    <div class="header-inner max-w-7xl mx-auto p-4 flex items-center justify-between">
                        <div class="brand flex items-center gap-3">
                            <div class="brand-logo w-12 h-12 bg-blue-600 text-white flex items-center justify-center font-extrabold rounded-lg">UA</div>
                            <div class="brand-text text-gray-800">
                                <strong class="text-base">Universidade Alfa</strong>
                                <div class="brand-sub text-sm text-gray-500">Ouvidoria ‚Äî Simula√ß√£o</div>
                            </div>
                        </div>
                        <nav class="top-nav hidden md:flex space-x-4">
                            <a href="#quem-somos" onclick="event.preventDefault()" class="text-sm text-gray-700 hover:text-blue-600 transition">Quem somos</a>
                            <a href="#contato" onclick="event.preventDefault()" class="text-sm text-gray-700 hover:text-blue-600 transition">Fale conosco</a>
                            <a href="#apoie" onclick="event.preventDefault()" class="cta bg-[var(--accent)] text-white text-sm px-3 py-1.5 rounded-lg font-semibold hover:bg-red-700 transition">Apoie</a>
                        </nav>
                    </div>
                </header>

                <main class="main max-w-7xl mx-auto p-4 lg:p-6">
                    <div class="main-inner">
                        ${mainContent}

                        <aside class="aside w-full lg:w-auto">
                            <div class="contact-box bg-white p-4 rounded-lg shadow-md border border-gray-100 mb-4">
                                <h3 class="text-xl font-bold mb-2 text-gray-800">Canal de relacionamento</h3>
                                <p class="text-gray-600 mb-2">Para confirmar: <strong>ouvidoria@universidadealfa.sim</strong></p>
                                <p class="text-gray-600">Telefone: <strong>(11) 4000-0000</strong></p>
                            </div>

                            <div class="info-box bg-white p-4 rounded-lg shadow-md border border-gray-100">
                                <h4 class="text-lg font-bold mb-2 text-gray-800">Privacidade</h4>
                                <p class="text-sm text-gray-600">Os dados desta simula√ß√£o s√£o armazenados localmente no navegador (localStorage).</p>
                                <div class="mt-4">
                                    <button type="button" onclick="handleClearStorageConfirm()" class="w-full btn px-4 py-2 text-sm rounded-lg font-semibold btn-secondary hover:bg-gray-200 transition">Limpar Dados Locais</button>
                                </div>
                            </div>
                        </aside>
                    </div>
                </main>

                <footer class="footer mt-10 border-t border-gray-200 bg-white">
                    <div class="footer-inner max-w-7xl mx-auto p-5 flex flex-col md:flex-row justify-between items-center text-center md:text-left">
                        <div class="mb-4 md:mb-0">
                            <h4 class="text-base font-semibold text-gray-800">Receba nossas atualiza√ß√µes</h4>
                            <p class="text-sm text-gray-600">Projeto educativo ‚Äî n√£o colete dados reais.</p>
                        </div>
                        <div>
                            <small class="text-gray-500">Universidade Alfa ‚Äî Simula√ß√£o</small>
                        </div>
                    </div>
                </footer>
            `;

            // **IMPORTANTE:** Ap√≥s a re-renderiza√ß√£o, sincroniza os valores do estado JS com os inputs do DOM.
            if (!submitted) {
                bindFormToState();
            }
        }

        // =================================================================
        // Inicializa√ß√£o
        // =================================================================

        window.onload = () => {
            // Tenta carregar a √∫ltima submiss√£o ao iniciar para popular o Checklist, se houver
            const todas = JSON.parse(localStorage.getItem("denuncias")) || [];
            if (todas.length > 0) {
                lastSubmission = todas[todas.length - 1];
            }
            render();
        };

    </script>
</body>
</html>